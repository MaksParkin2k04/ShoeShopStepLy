@page "/OrderLabel/{orderId}"
@model ShoeShop.Pages.OrderLabelModel
@{
    ViewData["Title"] = "–≠—Ç–∏–∫–µ—Ç–∫–∞ –∑–∞–∫–∞–∑–∞";
    Layout = null;
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>–≠—Ç–∏–∫–µ—Ç–∫–∞ –∑–∞–∫–∞–∑–∞ ‚Ññ@Model.Order?.Id</title>
    <link rel="stylesheet" href="~/styles/label-print.css" />
</head>
<body>
    @if (Model.Order != null)
    {
        <div class="label">
            <div class="header">
                <div class="company-name">StepLy</div>
                <div class="order-number">–ó–∞–∫–∞–∑ ‚Ññ@Model.Order.Id</div>
                <div class="payment-status">
                    @if (Model.Order.PaymentDate.HasValue || Model.Order.Status == ShoeShop.Models.OrderStatus.Paid)
                    {
                        <span class="paid">‚úì –û–ü–õ–ê–ß–ï–ù–û</span>
                    }
                    else
                    {
                        <span class="unpaid">‚úó –ù–ï –û–ü–õ–ê–ß–ï–ù–û</span>
                    }
                </div>
            </div>

            <div class="section">
                <div class="section-title">–ü–æ–ª—É—á–∞—Ç–µ–ª—å:</div>
                <div class="recipient-info">
                    <div><strong>@Model.Order.Recipient.Name</strong></div>
                    <div>@Model.Order.Recipient.Phone</div>
                    <div>@Model.Order.Recipient.City</div>
                    <div>@Model.Order.Recipient.Street, @Model.Order.Recipient.House</div>
                    @if (!string.IsNullOrEmpty(Model.Order.Recipient.Apartment))
                    {
                        <div>–∫–≤. @Model.Order.Recipient.Apartment</div>
                    }
                </div>
            </div>

            <div class="section">
                <div class="section-title">–¢–æ–≤–∞—Ä—ã:</div>
                <div class="items-list">
                    @foreach (var item in Model.Order.OrderDetails)
                    {
                        <div class="item">
                            @item.Name (—Ä–∞–∑–º–µ—Ä @item.Size) - @item.Price‚ÇΩ
                        </div>
                    }
                </div>
            </div>

            <div class="total">
                –ò—Ç–æ–≥–æ: @Model.Order.OrderDetails.Sum(x => x.Price)‚ÇΩ
            </div>

            <div class="section">
                <div class="section-title">–î–æ—Å—Ç–∞–≤–∫–∞:</div>
                <div style="font-size: 12px;">
                    @switch (Model.Order.DeliveryType)
                    {
                        case ShoeShop.Models.DeliveryType.Courier:
                            <div>üöö –ö—É—Ä—å–µ—Ä—Å–∫–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞</div>
                            break;
                        case ShoeShop.Models.DeliveryType.Pickup:
                            <div>üè¢ –°–∞–º–æ–≤—ã–≤–æ–∑ –∏–∑ –º–∞–≥–∞–∑–∏–Ω–∞</div>
                            break;
                        case ShoeShop.Models.DeliveryType.RussianPost:
                            <div>üìÆ –ü–æ—á—Ç–∞ –†–æ—Å—Å–∏–∏</div>
                            break;
                        case ShoeShop.Models.DeliveryType.CDEK:
                            <div>üì¶ –°–î–≠–ö</div>
                            break;
                        case ShoeShop.Models.DeliveryType.Boxberry:
                            <div>üì¶ Boxberry</div>
                            break;
                    }
                </div>
            </div>
            
            <div class="section">
                <div class="section-title">–û–ø–ª–∞—Ç–∞:</div>
                <div style="font-size: 12px;">
                    @if (Model.Order.PaymentType == ShoeShop.Models.PaymentType.Online)
                    {
                        <div>–û–Ω–ª–∞–π–Ω –æ–ø–ª–∞—Ç–∞</div>
                        @if (Model.Order.PaymentDate.HasValue)
                        {
                            <div>–û–ø–ª–∞—á–µ–Ω–æ: @Model.Order.PaymentDate.Value.ToString("dd.MM.yyyy HH:mm")</div>
                        }
                        else
                        {
                            <div>–û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã</div>
                        }
                    }
                    else
                    {
                        <div>–û–ø–ª–∞—Ç–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏</div>
                    }
                </div>
            </div>

            <div class="section" style="margin-top: 15px; font-size: 10px;">
                <div>–î–∞—Ç–∞: @Model.Order.CreatedDate.ToString("dd.MM.yyyy HH:mm")</div>
                @if (!string.IsNullOrEmpty(Model.Order.Coment))
                {
                    <div>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: @Model.Order.Coment</div>
                }
            </div>

            @if (!string.IsNullOrEmpty(Model.QRCodeBase64))
            {
                <div class="qr-section">
                    <div class="section-title">–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞:</div>
                    <img src="data:image/png;base64,@Model.QRCodeBase64" alt="QR –∫–æ–¥ –∑–∞–∫–∞–∑–∞" class="qr-code" />
                    <div style="font-size: 8px; text-align: center; margin-top: 5px;">–°–∫–∞–Ω–∏—Ä—É–π—Ç–µ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è</div>
                </div>
            }
        </div>
    }

    <div class="no-print" style="margin-top: 20px; text-align: center;">
        <button onclick="window.print()" class="btn btn-primary">–ü–µ—á–∞—Ç—å</button>
        <button onclick="window.close()" class="btn btn-secondary">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>

    <script>
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—á–∞—Ç—å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            setTimeout(function() {
                window.print();
            }, 500);
        };
    </script>
</body>
</html>